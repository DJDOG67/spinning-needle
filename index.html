<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- âœ… Firebase CDN (compat ë²„ì „: ì „ì—­ ê°ì²´ ì‚¬ìš©) -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Spinning Needle</title>
  <link rel="stylesheet" href="style/main.css">
</head>
<body>
  <!-- ğŸŒ GNB (Global Navigation Bar) -->
  <header class="gnb">
    <div class="gnb-left">
      <h1 class="logo">ğŸšï¸ Spinning Needle</h1>
    </div>
    <div class="gnb-center">
      <!-- ë¡œê·¸ì¸ ì „ -->
      <div id="authButtons">
<button class="btn-neon" id="loginBtn">LOGIN</button>
<button class="btn-neon-outline" id="signupBtn">SIGN UP</button>
      </div>
      <!-- ë¡œê·¸ì¸ í›„ -->
      <div class="gnb-user hidden" id="userProfile">
        <div class="user-toggle">
          <img src="assets/img/profile_default.png" class="profile-img" />
          <span id="userNickname">ë‹‰ë„¤ì„</span>
        </div>
        <div class="user-dropdown hidden" id="userMenu"></div>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="search-wrapper">
      <input
        type="text"
        class="search-input"
        id="searchInput"
        placeholder="Dark Side of the Moon ë¹„í•˜ì¸ë“œ"
        oninput="handleSearch(this.value)"
        onfocus="enableFocusMode()"
        onblur="hideAutocomplete()"
      />
      <div class="autocomplete" id="autocomplete-list"></div>
    </div>
    <h1>Now Spinning</h1>
    <img src="assets/img/sample-cover.jpg" alt="Album Cover" class="cover" />
    <p class="comment">â€œì†Œë¦¬ ìœ„ì— ë‚¨ê²¨ì§„ í”ì â€</p>
    <div class="buttons">
      <a href="#" class="btn">READ</a>
      <a href="#" class="btn">LISTEN</a>
    </div>
  </section>

  <section class="recommended">
    <h2>ì¶”ì²œ ìŒë°˜</h2>
    <div class="dropdowns">
      <div class="dropdown">
        <button class="dropbtn">ğŸ¼ ì¥ë¥´ë³„</button>
        <div class="dropdown-content">
          <a href="#">Rock</a>
          <a href="#">Jazz</a>
          <a href="#">Soul</a>
          <a href="#">Experimental</a>
        </div>
      </div>
      <div class="dropdown">
        <button class="dropbtn">ğŸ•° ì‹œëŒ€ë³„</button>
        <div class="dropdown-content">
          <a href="#">60s</a>
          <a href="#">70s</a>
          <a href="#">80s</a>
          <a href="#">Now</a>
        </div>
      </div>
      <div class="dropdown">
        <button class="dropbtn">ğŸŒ êµ­ê°€ë³„</button>
        <div class="dropdown-content">
          <a href="#">USA</a>
          <a href="#">UK</a>
          <a href="#">Korea</a>
          <a href="#">Japan</a>
        </div>
      </div>
    </div>
  </section>

  <section class="my-vault">
    <h2>ë‚˜ì˜ ì°½ê³ </h2>
    <div class="vault-section liked-artists">
      <h3>â¤ï¸ ì¢‹ì•„ìš”í•œ ì•„í‹°ìŠ¤íŠ¸</h3>
      <div class="artist-list">
        <div class="artist">Radiohead</div>
        <div class="artist">Miles Davis</div>
        <div class="artist">Portishead</div>
      </div>
    </div>
    <div class="vault-section saved-magazines">
      <h3>ğŸ“š ì €ì¥í•œ ë§¤ê±°ì§„</h3>
      <div class="magazine-list">
        <div class="magazine-card">Sun Raì˜ ì¬ë°œê²¬</div>
        <div class="magazine-card">The Who: Quadrophenia</div>
      </div>
    </div>
    <div class="vault-section activity-report">
      <h3>ğŸ“Š í™œë™ ë¦¬í¬íŠ¸</h3>
      <div class="report-cards">
        <div class="report-card">
          <div class="report-icon">ğŸ’¬</div>
          <div class="report-number">12</div>
          <div class="report-label">ì‘ì„±í•œ ëŒ“ê¸€</div>
        </div>
        <div class="report-card">
          <div class="report-icon">â¤ï¸</div>
          <div class="report-number">23</div>
          <div class="report-label">ì¢‹ì•„ìš”í•œ ë§¤ê±°ì§„</div>
        </div>
        <div class="report-card">
          <div class="report-icon">ğŸ¼</div>
          <div class="report-number">Jazz, Psychedelic</div>
          <div class="report-label">ì„ í˜¸ ì¥ë¥´</div>
        </div>
      </div>
    </div>
  </section>

  <section class="inside-music">
    <h2>ìŒì•…ì˜ ë’·ì´ì•¼ê¸° ğŸ™ï¸</h2>
    <div class="insight-grid">
      <div class="insight-card">
        <h3>ğŸ¤ ì¸í„°ë·°</h3>
        <p>â€œSun Raê°€ ë§í•˜ëŠ” ìš°ì£¼ì˜ ìŒì•…â€<br>íë ˆì´í„° Hide_Kimê³¼ì˜ ì§§ì€ ëŒ€í™”</p>
        <a href="#" class="btn-mini">ìì„¸íˆ ë³´ê¸°</a>
      </div>
      <div class="insight-card">
        <h3>ğŸ¨ ì»¤ë²„ ì•„íŠ¸ ë©”ì´í‚¹</h3>
        <p>Quadropheniaì˜ ì•¨ë²” ì»¤ë²„ ìŠ¤ì¼€ì¹˜ì™€ ë¯¸ê³µê°œ ì½˜ì…‰íŠ¸ ì•„íŠ¸</p>
        <a href="#" class="btn-mini">ë³´ê¸°</a>
      </div>
      <div class="insight-card video-card">
        <h3>ğŸ¥ ì˜ìƒ ì•„ì¹´ì´ë¸Œ</h3>
        <iframe width="100%" height="200" src="https://www.youtube.com/embed/1LMSOfs10mA" title="YouTube video player" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>
  </section>

  <section class="featured-curation">
    <h2>ğŸƒ ì˜¤ëŠ˜ì˜ íë ˆì´ì…˜</h2>
    <div class="featured-card">
      <img src="assets/img/sample-cover.jpg" alt="íë ˆì´ì…˜ ì»¤ë²„" />
      <div class="card-info">
        <h3>Velvet Underground â€“ Noise is a Drug</h3>
        <p>â€œë„ì‹œì˜ ì†ŒìŒ ì†ì—ì„œ í”¼ì–´ë‚˜ëŠ” ë¬´ì˜ì‹ì˜ ë¦¬ë“¬â€</p>
      </div>
    </div>
    <a href="library.html" class="library-btn">
      <span>ENTER</span> DIGITAL LIBRARY â†’
    </a>
  </section>

  <!-- ğŸ“¦ í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„¹ì…˜ -->
  <section class="profile-upload-section hidden" id="profileSection">
    <h2>ğŸ‘¤ í”„ë¡œí•„ ì´ë¯¸ì§€ ë“±ë¡</h2>
    <div class="profile-box">
      <label for="profileImageInput" class="upload-label">
        <img id="previewImage" src="assets/img/profile_default.png" alt="ë¯¸ë¦¬ë³´ê¸°" class="preview-img" />
        <span class="upload-text">ì´ë¯¸ì§€ ì„ íƒ</span>
      </label>
      <input type="file" id="profileImageInput" accept="image/*" onchange="previewProfileImage()" />
      <button onclick="saveProfileLocally()" class="btn-neon-outline">ì €ì¥</button>
    </div>
  </section>

  <a href="editor-canvas.html" id="writeBtn" class="write-button fancy-write" style="display: none;">
    âœï¸ ë§¤ê±°ì§„ ì“°ê¸°
  </a>

  <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… ëª¨ë‹¬ -->
  <div id="authModal" class="modal hidden">
    <div class="modal-glass">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle">ë¡œê·¸ì¸</h2>
      <form id="authForm" onsubmit="handleAuth(event)">
        <div class="input-group">
          <input type="email" id="authUsername" placeholder="ì´ë©”ì¼ ì£¼ì†Œ (example@gmail.com)" required />
        </div>
        <div class="input-group">
          <input type="password" id="authPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" required />
        </div>
        <button type="submit" class="btn-neon-wide">ì…ì¥í•˜ê¸°</button>
      </form>
      <p class="toggle-text">
        <span onclick="toggleAuthMode()">íšŒì›ê°€ì… / ë¡œê·¸ì¸ ì „í™˜</span>
      </p>
      <p id="authMessage"></p>
      <p class="resend-text">
        ì¸ì¦ ë©”ì¼ì„ ë°›ì§€ ëª»í•˜ì…¨ë‚˜ìš”?
        <button type="button" onclick="resendVerificationEmail()" class="btn-neon-outline btn-small">ì¬ë°œì†¡</button>
      </p>
    </div>
  </div>

<script type="module">
  import {
    toggleAuthMode,
    handleAuth,
    firebaseLogout,
    resendVerificationEmail,
    saveProfileLocally
  } from './script/login.js';

  // í•¨ìˆ˜ ì„ ì–¸
  function showLogin() {
    const modal = document.getElementById("authModal");
    if (modal) {
      modal.classList.remove("hidden");
      const titleEl = document.getElementById("modalTitle");
      if (titleEl) titleEl.textContent = "ë¡œê·¸ì¸";
    }
  }

  function showSignup() {
    const modal = document.getElementById("authModal");
    if (modal) {
      modal.classList.remove("hidden");
      const titleEl = document.getElementById("modalTitle");
      if (titleEl) titleEl.textContent = "íšŒì›ê°€ì…";
    }
  }

  function closeModal() {
    const modal = document.getElementById("authModal");
    if (modal) modal.classList.add("hidden");
  }

  // ì „ì—­ ë“±ë¡
  window.showLogin = showLogin;
  window.showSignup = showSignup;
  window.closeModal = closeModal;
  window.toggleAuthMode = toggleAuthMode;
  window.handleAuth = handleAuth;
  window.firebaseLogout = firebaseLogout;
  window.resendVerificationEmail = resendVerificationEmail;
  window.saveProfileLocally = saveProfileLocally;

  // ë¡œê·¸ì¸ ë²„íŠ¼ ì—°ê²°
  document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("loginBtn")?.addEventListener("click", showLogin);
    document.getElementById("signupBtn")?.addEventListener("click", showSignup);
  });

  // ìœ ì € ë©”ë‰´ í† ê¸€
  document.addEventListener("DOMContentLoaded", () => {
    const userToggle = document.querySelector(".user-toggle");
    const userMenu = document.getElementById("userMenu");

    if (userToggle && userMenu) {
      userToggle.addEventListener("click", () => {
        userMenu.classList.toggle("hidden");
      });
    }
  });

  // ë°”ê¹¥ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
  document.addEventListener("click", (event) => {
    const userToggle = document.querySelector(".user-toggle");
    const userMenu = document.getElementById("userMenu");

    if (!userToggle || !userMenu) return;
    if (!userToggle.contains(event.target) && !userMenu.contains(event.target)) {
      userMenu.classList.add("hidden");
    }
  });
</script>



</body>
</html>